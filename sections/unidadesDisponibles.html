<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unidades Disponibles - Larrosa Camiones</title>
    <meta name="description" content="Explora nuestra amplia selecci√≥n de camiones usados. Filtra por marca, a√±o, kil√≥metros y m√°s. M√°s de 40 a√±os de experiencia en el sector.">
    <meta name="keywords" content="camiones usados, venta camiones, Larrosa, C√≥rdoba, Scania, Volvo, Mercedes, tractoras, r√≠gidos">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/unidadesDisponibles.css">
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <!-- Navegaci√≥n fija -->
        <nav class="navbar">
            <div class="nav-container">
                <!-- Logo -->
                <div class="nav-logo">
                    <a href="../index.html">
                        <img src="../assets/Original.pdf" alt="Larrosa Camiones" class="logo">
                    </a>
                </div>
                
                <!-- Men√∫ principal -->
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="../index.html" class="nav-link">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a href="unidadesDisponibles.html" class="nav-link active">Unidades Disponibles</a>
                    </li>
                    <li class="nav-item">
                        <a href="LarrosaCamiones.html" class="nav-link">Larrosa Camiones</a>
                    </li>
                    <li class="nav-item">
                        <a href="contacto.html" class="nav-link">Contacto</a>
                    </li>
                </ul>
                
                <!-- Bot√≥n derecha -->
                <div class="nav-button">
                    <!-- Bot√≥n MercadoLibre -->
        
                    <!-- Bot√≥n Randon -->
                    <a href="LarrosaCamiones.html#randon" class="btn-special">
                        <img src="../assets/Logo negro sin fondo.png" alt="Randon" class="btn-icon">
                    </a>
                </div>
                
                <!-- Hamburger para m√≥vil -->
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main id="main-content">
        <!-- Page Header -->
        <section class="page-header">
            <div class="container-full">
                <div class="breadcrumb">
                    <a href="../index.html">Inicio</a>
                    <span class="separator">/</span>
                    <span class="current">Unidades Disponibles</span>
                </div>
                
                <!-- NUEVO: Vehicle Categories Bar - Ancho completo SIN espacios -->
                <div class="categories-container-full">
                    <div class="category-item active" data-category="all">
                        <div class="category-image">
                            <img src="../assets/imagenes/IMG_8670(1).JPEG" alt="Todos los veh√≠culos" class="category-photo">
                        </div>
                        <div class="category-info">
                            <span class="category-name">Todos</span>
                            <span class="category-count">(583)</span>
                        </div>
                    </div>
                    
                    <div class="category-item" data-category="camion-tractor">
                        <div class="category-image">
                            <img src="../assets/Camion Tractor.png" alt="Cami√≥n Tractor" class="category-photo">
                        </div>
                        <div class="category-info">
                            <span class="category-name">Cami√≥n Tractor</span>
                            <span class="category-count">(234)</span>
                        </div>
                    </div>
                    
                    <div class="category-item" data-category="camion-chasis">
                        <div class="category-image">
                            <img src="../assets/Camion Chasis.png" alt="Cami√≥n Chasis" class="category-photo">
                        </div>
                        <div class="category-info">
                            <span class="category-name">Cami√≥n Chasis</span>
                            <span class="category-count">(156)</span>
                        </div>
                    </div>
                    
                    <div class="category-item" data-category="remolques">
                        <div class="category-image">
                            <img src="../assets/Remolques.png" alt="Remolques" class="category-photo">
                        </div>
                        <div class="category-info">
                            <span class="category-name">Remolques</span>
                            <span class="category-count">(89)</span>
                        </div>
                    </div>
                    
                    <div class="category-item" data-category="utilitarios">
                        <div class="category-image">
                            <img src="../assets/Utilitarios.png" alt="Utilitarios" class="category-photo">
                        </div>
                        <div class="category-info">
                            <span class="category-name">Utilitarios</span>
                            <span class="category-count">(67)</span>
                        </div>
                    </div>
                    
                    <div class="category-item" data-category="varios">
                        <div class="category-image">
                            <img src="../assets/Varios.png" alt="Varios" class="category-photo">
                        </div>
                        <div class="category-info">
                            <span class="category-name">Varios</span>
                            <span class="category-count">(37)</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Main Content with Sidebar - SIN espacios entre categor√≠as y contenido -->
        <section class="content-section-full">
            <div class="content-layout-full">
                <!-- ACTUALIZADO: Sidebar Filters con altura completa -->
                <aside class="sidebar-filters-full">
                    <!-- Filter Search -->
                    <div class="filter-search">
                        <div class="search-input-container">
                            <input type="text" placeholder="Buscar camiones..." id="filter-search" class="filter-search-input">
                            <button class="clear-search-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="filter-actions">
                            <button class="clear-all-btn">
                                <span>Limpiar</span>
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="save-search-btn">
                                <span>Guardar</span>
                                <i class="fas fa-bookmark"></i>
                            </button>
                        </div>
                    </div>

                    <!-- NUEVO: Tipo Filter - Colapsable por defecto -->
                    <div class="filter-group collapsible collapsed">
                        <h3 class="filter-title" onclick="toggleFilterGroup(this)">
                            <span>Tipo</span>
                            <i class="fas fa-chevron-down collapse-icon"></i>
                        </h3>
                        <div class="filter-content">
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="tipo" value="camion-tractor">
                                    <span class="checkmark"></span>
                                    <img src="../assets/Camion Tractor.png" alt="Cami√≥n Tractor" class="filter-icon">
                                    <span class="option-text">Cami√≥n Tractor</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="tipo" value="camion-chasis">
                                    <span class="checkmark"></span>
                                    <img src="../assets/Camion Chasis.png" alt="Cami√≥n Chasis" class="filter-icon">
                                    <span class="option-text">Cami√≥n Chasis</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="tipo" value="remolques">
                                    <span class="checkmark"></span>
                                    <img src="../assets/Remolques.png" alt="Remolques" class="filter-icon">
                                    <span class="option-text">Remolques</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="tipo" value="utilitarios">
                                    <span class="checkmark"></span>
                                    <img src="../assets/Utilitarios.png" alt="Utilitarios" class="filter-icon">
                                    <span class="option-text">Utilitarios</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="tipo" value="varios">
                                    <span class="checkmark"></span>
                                    <img src="../assets/Varios.png" alt="Varios" class="filter-icon">
                                    <span class="option-text">Varios</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Tracci√≥n Filter - Colapsable -->
                    <div class="filter-group collapsible collapsed">
                        <h3 class="filter-title" onclick="toggleFilterGroup(this)">
                            <span>Tracci√≥n</span>
                            <i class="fas fa-chevron-down collapse-icon"></i>
                        </h3>
                        <div class="filter-content">
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="traccion" value="4x2">
                                    <span class="checkmark"></span>
                                    <span class="option-text">4x2</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="traccion" value="6x2">
                                    <span class="checkmark"></span>
                                    <span class="option-text">6x2</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Marca Filter - Colapsable -->
                    <div class="filter-group collapsible collapsed">
                        <h3 class="filter-title" onclick="toggleFilterGroup(this)">
                            <span>Marca</span>
                            <i class="fas fa-chevron-down collapse-icon"></i>
                        </h3>
                        <div class="filter-content">
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="marca" value="scania">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Scania</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="marca" value="volvo">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Volvo</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="marca" value="mercedes">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Mercedes</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="marca" value="iveco">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Iveco</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="marca" value="volkswagen">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Volkswagen</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="marca" value="renault">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Renault</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="marca" value="ford">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Ford</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- A√±o Range - Colapsable -->
                    <div class="filter-group collapsible collapsed">
                        <h3 class="filter-title" onclick="toggleFilterGroup(this)">
                            <span>A√±o</span>
                            <i class="fas fa-chevron-down collapse-icon"></i>
                        </h3>
                        <div class="filter-content">
                            <div class="range-filter">
                                <div class="range-inputs">
                                    <input type="number" placeholder="Desde" class="range-input" id="year-min" min="2000" max="2025">
                                    <span class="range-separator">-</span>
                                    <input type="number" placeholder="Hasta" class="range-input" id="year-max" min="2000" max="2025">
                                </div>
                                <div class="range-slider">
                                    <input type="range" class="slider" id="year-slider" min="2000" max="2025" value="2015">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Kil√≥metros Range - Colapsable -->
                    <div class="filter-group collapsible collapsed">
                        <h3 class="filter-title" onclick="toggleFilterGroup(this)">
                            <span>Kil√≥metros</span>
                            <i class="fas fa-chevron-down collapse-icon"></i>
                        </h3>
                        <div class="filter-content">
                            <div class="range-filter">
                                <div class="range-inputs">
                                    <input type="number" placeholder="Desde" class="range-input" id="km-min" min="0" max="1000000">
                                    <span class="range-separator">-</span>
                                    <input type="number" placeholder="Hasta" class="range-input" id="km-max" min="0" max="1000000">
                                </div>
                                <div class="range-slider">
                                    <input type="range" class="slider" id="km-slider" min="0" max="1000000" value="500000">
                                </div>
                                <div class="range-unit">km</div>
                            </div>
                        </div>
                    </div>

                    <!-- Transmisi√≥n Filter - Colapsable -->
                    <div class="filter-group collapsible collapsed">
                        <h3 class="filter-title" onclick="toggleFilterGroup(this)">
                            <span>Transmisi√≥n</span>
                            <i class="fas fa-chevron-down collapse-icon"></i>
                        </h3>
                        <div class="filter-content">
                            <div class="filter-options">
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="transmision" value="manual">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Manual</span>
                                </label>
                                <label class="filter-checkbox">
                                    <input type="checkbox" name="transmision" value="automatica">
                                    <span class="checkmark"></span>
                                    <span class="option-text">Autom√°tica</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- Main Content Area -->
                <div class="main-content-full">
                    <!-- Mobile Filter Toggle -->
                    <button class="mobile-filter-toggle">
                        <i class="fas fa-filter"></i>
                        <span>Filtros</span>
                    </button>

                    <!-- Results Header -->
                    <div class="results-header">
                        <div class="results-info">
                            <div class="results-tabs">
                                <button class="tab-btn active">
                                    <span>informaci√≥n</span>
                                </button>
                                <button class="tab-btn">
                                    <span><strong><span id="total-vehicles">583</span> veh√≠culos encontrados</strong></span>
                                </button>
                            </div>
                        </div>
                        <div class="results-controls">
                            <div class="sort-dropdown">
                                <button class="sort-btn">
                                    <span>Clasificar Por</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="sort-menu">
                                    <button class="sort-option active" data-sort="relevance">Relevancia</button>
                                    <button class="sort-option" data-sort="price-asc">Precio: menor a mayor</button>
                                    <button class="sort-option" data-sort="price-desc">Precio: mayor a menor</button>
                                    <button class="sort-option" data-sort="year-desc">A√±o: m√°s nuevo</button>
                                    <button class="sort-option" data-sort="year-asc">A√±o: m√°s viejo</button>
                                    <button class="sort-option" data-sort="km-asc">Menor kilometraje</button>
                                    <button class="sort-option" data-sort="km-desc">Mayor kilometraje</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div class="loading-state" id="loading-state" style="display: none;">
                        <div class="loading-spinner"></div>
                        <p>Cargando veh√≠culos...</p>
                    </div>



                    <!-- Load More Button -->
                    <div class="load-more-container">
                        <button class="load-more-btn" id="load-more-btn">
                            <span>Cargar m√°s veh√≠culos</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Overlay para m√≥vil -->
    <div class="filter-overlay" id="filter-overlay"></div>
    <section class="brands">
        <div class="container">
            <div class="brands-carousel">
                <div class="brands-track">
                    <img src="../assets/Scania.png" alt="Scania" class="brand-logo">
                    <img src="../assets/Volvo.png" alt="Volvo" class="brand-logo">
                    <img src="../assets/Mercedez.png" alt="Mercedes-Benz" class="brand-logo">
                    <img src="../assets/Iveco.png" alt="Iveco" class="brand-logo">
                    <img src="../assets/Volkswagen.png" alt="Volkswagen" class="brand-logo">
                    <img src="../assets/Renault.png" alt="Renault" class="brand-logo">
                    <img src="../assets/Ford.png" alt="Ford" class="brand-logo">
                    <img src="../assets/Logo negro sin fondo.png" alt="Randon" class="brand-logo">
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <img src="../assets/Blanco fondo negro.pdf" alt="Larrosa Camiones" class="footer-logo">
                    <p>40 a√±os comercializando camiones. Tu socio confiable en el transporte de cargas.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>Navegaci√≥n</h4>
                    <ul>
                        <li><a href="../index.html">Inicio</a></li>
                        <li><a href="unidadesDisponibles.html">Unidades Disponibles</a></li>
                        <li><a href="LarrosaCamiones.html">Larrosa Camiones</a></li>
                        <li><a href="contacto.html">Contacto</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>La Empresa</h4>
                    <ul>
                        <li><a href="LarrosaCamiones.html#historia">Nuestra Historia</a></li>
                        <li><a href="LarrosaCamiones.html#valores">Valores</a></li>
                        <li><a href="LarrosaCamiones.html#randon">Concesi√≥n Randon</a></li>
                        <li><a href="LarrosaCamiones.html#instalaciones">Instalaciones</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Contacto</h4>
                    <div class="contact-info">
                        <p><i class="fas fa-map-marker-alt"></i> Villa Mar√≠a, C√≥rdoba</p>
                        <p><i class="fas fa-phone"></i> +54 353 XXX-XXXX</p>
                        <p><i class="fas fa-envelope"></i> info@larrosacamiones.com</p>
                    </div>
                </div>
            </div>
            
            <!-- Nueva secci√≥n admin -->
            <div class="footer-admin">
                <a href="../admin/login.html" 
                   class="btn-admin-footer" 
                   title="Panel de Administraci√≥n">
                    <i class="fas fa-user-shield"></i>
                    <span>Administraci√≥n</span>
                </a>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Larrosa Camiones. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

   <!-- ===== SCRIPTS - SOLO API ===== -->
   <script>
    // Verificar que no hay conflictos
    console.log('üîß Limpiando scripts anteriores...');
    
    // Remover variables globales conflictivas si existen
    if (window.vehiclesData) delete window.vehiclesData;
    if (window.filteredVehicles) delete window.filteredVehicles;
    if (window.isLoading) delete window.isLoading;
    
    console.log('‚úÖ Scripts limpiados');
</script>

<!-- API Client -->
<script src="../scripts/api.js"></script>

<!-- SOLO EL ARCHIVO DE API -->
<script>
    // ===== IMPLEMENTACI√ìN DIRECTA PARA EVITAR CONFLICTOS =====
    console.log('üöõ Iniciando Unidades Disponibles - API Direct...');
    
    let apiVehicles = [];
    let apiFiltered = [];
    let apiLoading = false;
    
    // Inicializar cuando el DOM est√© listo
    document.addEventListener('DOMContentLoaded', async function() {
        console.log('üìã DOM cargado, conectando a API...');
        
        // Verificar API Client
        if (!window.APIClient) {
            console.error('‚ùå APIClient no disponible');
            showError('Sistema API no disponible');
            return;
        }
        
        // Crear instancia del cliente API
        const apiClient = new APIClient();
        window.apiClient = apiClient;
        
        // Cargar veh√≠culos
        await loadVehiclesFromAPI();
        
        // Configurar categor√≠as
        setupCategories();
        
        console.log('‚úÖ Sistema inicializado correctamente');
    });
    
    // Cargar veh√≠culos desde API
    async function loadVehiclesFromAPI() {
        try {
            console.log('üîÑ Cargando veh√≠culos desde API...');
            showLoading(true);
            
            // Test de conexi√≥n primero
            const healthResponse = await fetch('http://localhost:8000/health');
            if (!healthResponse.ok) {
                throw new Error('Backend no disponible');
            }
            
            console.log('‚úÖ Backend conectado');
            
            // Obtener veh√≠culos
            const vehiclesResponse = await fetch('http://localhost:8000/api/v1/vehicles?limit=100');
            
            if (!vehiclesResponse.ok) {
                throw new Error(`HTTP ${vehiclesResponse.status}: ${vehiclesResponse.statusText}`);
            }
            
            const data = await vehiclesResponse.json();
            console.log('üìä Respuesta de API:', data);
            
            if (data.vehicles && data.vehicles.length > 0) {
                apiVehicles = data.vehicles;
                apiFiltered = [...apiVehicles];
                
                console.log(`‚úÖ ${apiVehicles.length} veh√≠culos cargados`);
                
                // Actualizar contador
                updateVehicleCount(apiVehicles.length);
                
                // Renderizar
                renderVehicles();
                
            } else {
                console.warn('‚ö†Ô∏è No se encontraron veh√≠culos');
                showEmpty();
            }
            
        } catch (error) {
            console.error('‚ùå Error cargando veh√≠culos:', error);
            showError(`Error: ${error.message}`);
        } finally {
            showLoading(false);
        }
    }
    
    // Renderizar veh√≠culos
    function renderVehicles() {
        const grid = document.getElementById('vehicles-grid');
        if (!grid) {
            console.error('‚ùå Grid no encontrado');
            return;
        }
        
        console.log(`üé® Renderizando ${apiFiltered.length} veh√≠culos...`);
        
        if (apiFiltered.length === 0) {
            showEmpty();
            return;
        }
        
        // Limpiar grid
        grid.innerHTML = '';
        
        // Crear cards
        apiFiltered.forEach((vehicle, index) => {
            const card = createVehicleCard(vehicle);
            card.style.animationDelay = `${index * 0.1}s`;
            card.classList.add('fade-in');
            grid.appendChild(card);
        });
        
        console.log(`‚úÖ ${apiFiltered.length} tarjetas renderizadas`);
    }
    
    // Crear tarjeta de veh√≠culo
    function createVehicleCard(vehicle) {
        const card = document.createElement('div');
        card.className = 'vehicle-card';
        card.dataset.vehicleId = vehicle.id;
        
        // Imagen segura
        const imageUrl = getVehicleImage(vehicle);
        
        card.innerHTML = `
            <div class="vehicle-image">
                <img src="${imageUrl}" alt="${vehicle.full_name}" loading="lazy"
                     onerror="this.src='../assets/imagenes/placeholder-vehicle.jpg'">
                <div class="vehicle-status available">${vehicle.status || 'Disponible'}</div>
            </div>
            <div class="vehicle-content">
                <h3 class="vehicle-title">${vehicle.full_name}</h3>
                <p class="vehicle-subtitle">${vehicle.type_name || 'Veh√≠culo comercial'}</p>
                <div class="vehicle-specs">
                    <div class="vehicle-spec">
                        <span class="vehicle-spec-icon">üìÖ</span>
                        <span class="vehicle-spec-value">${vehicle.year}</span>
                    </div>
                    <div class="vehicle-spec">
                        <span class="vehicle-spec-icon">üõ£Ô∏è</span>
                        <span class="vehicle-spec-value">${formatKilometers(vehicle.kilometers)} km</span>
                    </div>
                    <div class="vehicle-spec">
                        <span class="vehicle-spec-icon">‚öôÔ∏è</span>
                        <span class="vehicle-spec-value">${vehicle.transmission || 'Manual'}</span>
                    </div>
                    <div class="vehicle-spec">
                        <span class="vehicle-spec-icon">üîã</span>
                        <span class="vehicle-spec-value">${vehicle.power || 0} HP</span>
                    </div>
                </div>
            </div>
            <div class="vehicle-footer">
                <div class="vehicle-location">
                    <span>üá¶üá∑</span>
                    <span>${vehicle.location || 'Villa Mar√≠a, C√≥rdoba'}</span>
                </div>
            </div>
        `;
        
        // Click handler
        card.addEventListener('click', function() {
            sessionStorage.setItem('currentVehicle', JSON.stringify(vehicle));
            window.location.href = `detalleVehiculo.html?id=${vehicle.id}`;
        });
        
        return card;
    }
    
    // Configurar categor√≠as
    function setupCategories() {
        const categoryItems = document.querySelectorAll('.category-item');
        
        categoryItems.forEach(item => {
            item.addEventListener('click', function() {
                // Remover active de todas
                categoryItems.forEach(cat => cat.classList.remove('active'));
                // Activar actual
                this.classList.add('active');
                
                // Filtrar
                const category = this.dataset.category;
                filterByCategory(category);
            });
        });
    }
    
    // Filtrar por categor√≠a
    function filterByCategory(category) {
        console.log(`üè∑Ô∏è Filtrando por categor√≠a: ${category}`);
        
        if (category === 'all') {
            apiFiltered = [...apiVehicles];
        } else {
            apiFiltered = apiVehicles.filter(v => v.type === category);
        }
        
        console.log(`üìä ${apiFiltered.length} veh√≠culos despu√©s del filtro`);
        
        // Actualizar contador
        updateVehicleCount(apiFiltered.length);
        
        // Re-renderizar
        renderVehicles();
    }
    
    // Utilidades
    function getVehicleImage(vehicle) {
        if (vehicle.images && vehicle.images.length > 0) {
            // Si tiene im√°genes, usar la primera
            const imagePath = vehicle.images[0];
            if (imagePath.startsWith('http')) {
                return imagePath;
            } else if (imagePath.startsWith('/static')) {
                return `http://localhost:8000${imagePath}`;
            }
        }
        return '../assets/imagenes/placeholder-vehicle.jpg';
    }
    
    function formatKilometers(km) {
        if (!km) return '0';
        return new Intl.NumberFormat('es-AR').format(km);
    }
    
    function updateVehicleCount(count) {
        const totalElement = document.getElementById('total-vehicles');
        if (totalElement) {
            totalElement.textContent = count;
        }
    }
    
    function showLoading(show) {
        const grid = document.getElementById('vehicles-grid');
        if (!grid) return;
        
        if (show) {
            grid.innerHTML = '<div class="loading">üîÑ Cargando veh√≠culos desde API...</div>';
        }
    }
    
    function showEmpty() {
        const grid = document.getElementById('vehicles-grid');
        if (grid) {
            grid.innerHTML = `
                <div class="empty-state">
                    <h3>üöõ No hay veh√≠culos disponibles</h3>
                    <p>No se encontraron veh√≠culos en la base de datos.</p>
                    <button onclick="loadVehiclesFromAPI()" class="btn-retry">
                        üîÑ Reintentar
                    </button>
                </div>
            `;
        }
    }
    
    function showError(message) {
        const grid = document.getElementById('vehicles-grid');
        if (grid) {
            grid.innerHTML = `
                <div class="error-state">
                    <h3>‚ùå Error al cargar veh√≠culos</h3>
                    <p>${message}</p>
                    <p>Aseg√∫rate de que el backend est√© funcionando en <code>localhost:8000</code></p>
                    <button onclick="loadVehiclesFromAPI()" class="btn-retry">
                        üîÑ Reintentar
                    </button>
                </div>
            `;
        }
    }
    
    // CSS para estados
    const style = document.createElement('style');
    style.textContent = `
        .loading, .empty-state, .error-state {
            padding: 60px 20px;
            text-align: center;
            color: #666;
            grid-column: 1 / -1;
        }
        
        .btn-retry {
            background: #3D5FAC;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .vehicle-spec-icon {
            margin-right: 8px;
            font-size: 14px;
        }
        
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease forwards;
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    `;
    document.head.appendChild(style);
    
    // Exponer funciones para debug
    window.loadVehiclesFromAPI = loadVehiclesFromAPI;
    window.apiVehicles = () => apiVehicles;
    window.apiFiltered = () => apiFiltered;
    
    console.log('üöõ Sistema de veh√≠culos API cargado');
</script>

<!-- Nav session script -->
<script src="../scripts/nav-session.js"></script>


</html>